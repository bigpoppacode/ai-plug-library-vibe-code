# AI Driven Lead Management And Inquiry Automation With Erpnext & N8n
## üöÄ What It Does
Moves data between apps and a **database/spreadsheet**, with logic and optional AI steps.

## üíº Business Use Case
Use as a **glue/API broker**: receive data, enrich/validate via APIs, and pass to downstream systems.

## ‚öôÔ∏è How It Works
1. **Trigger:** This workflow starts with **Sticky Note2**.
2. **OpenAI Chat Model** `lmChatOpenAi` ‚Äî options: "[object Object]"
3. **Abbriviations** `googleSheetsTool` ‚Äî options: "[object Object]", sheetName: "[object Object]", documentId: "[object Object]"
4. **Company Profile** `googleDocsTool` ‚Äî operation: **get**
5. **Company Policies** `googleDocsTool` ‚Äî operation: **get**
6. **Company Contact Database** `googleSheetsTool` ‚Äî sheetName: "[object Object]", documentId: "[object Object]"
7. **Sticky Note4** `stickyNote` ‚Äî color: "6", width: "297.84037615575886", height: "643.0692298205195"
8. **Sticky Note6** `stickyNote` ‚Äî color: "3", width: "302.58963031819115", height: "660"
9. **Sticky Note** `stickyNote` ‚Äî color: "7", width: "764.2159851725196", height: "648.5051458745236"
10. **Sticky Note2** `stickyNote` ‚Äî color: "5", width: "398", height: "642"
11. **Sticky Note7** `stickyNote` ‚Äî color: "4", width: "388.6432532629275", height: "662"
12. **Sticky Note12** `stickyNote` ‚Äî color: "5", width: "248.905549047384", height: "654.6630436071407"
13. **Sticky Note13** `stickyNote` ‚Äî color: "6", width: "222.5278407657604", height: "651.0941643427163"
14. **Sticky Note14** `stickyNote` ‚Äî color: "6", width: "399.43186296400074", height: "662"
15. **Sticky Note11** `stickyNote` ‚Äî color: "4", width: "475.27306699862953", height: "636.1483291619771"
16. **Sticky Note16** `stickyNote` ‚Äî color: "5", width: "248.905549047384", height: "654.6630436071407"
17. **Sticky Note10** `stickyNote` ‚Äî color: "3", width: "302.58963031819115", height: "660"
18. **Webhook** `webhook` ‚Äî method: **POST**, path: `/new-lead-generated-in-erpnext`
19. **Source Website and Status Open** `if` ‚Äî options: "[object Object]", conditions: "[object Object]"
20. **Lead Body** `set` ‚Äî options: "[object Object]", assignments: "[object Object]"
21. **Get Lead Data from ERPNext** `httpRequest` ‚Äî url: `=https://erpnext.syncbricks.com/api/resource/Lead/{{ $('Source Website and Status Open').item.json.body.name }}`
22. **Inquiry has Notes** `if` ‚Äî options: "[object Object]", conditions: "[object Object]"
23. **Customer Lead AI Agent** `agent` ‚Äî text: "=**System Prompt:**

You are an AI assistant designed to process new leads and generate appropriate responses. Your role includes analyzing lead notes, categorizing them, and gener‚Ä¶[truncated]", options: "[object Object]", promptType: "define"
24. **Inquiry is Valid?** `if` ‚Äî options: "[object Object]", conditions: "[object Object]"
25. **Fields for Outlook** `code` ‚Äî jsCode: "// Input text from the `output` field
const textOutput = $json?.output || '';

// Function to extract values from the text
function extractFields(text) {
 const fields = {};

 // R‚Ä¶[truncated]"
26. **Email Body Text Generated by AI** `set` ‚Äî options: "[object Object]", assignments: "[object Object]"
27. **Email Body for Outlook** `code` ‚Äî jsCode: "// Input email body
const emailBody = $json.email_body || '';

// Function to convert plain text email body into HTML
function formatEmailBodyAsHtml(body) {
 // Replace markdown-li‚Ä¶[truncated]"
28. **Microsoft Outlook** `microsoftOutlook` ‚Äî subject: "={{ $('Fields for Outlook').item.json.subject }}", bodyContent: "={{ $json.html }}
<a href="https://erpnext.syncbricks.com/app/lead/{{ $('Webhook').item.json.body.name }}" target="_blank" rel="noopener noreferrer">Here is Lead {{ $('Source Websi‚Ä¶[truncated]", toRecipients: "= {{ $('Fields for Outlook').item.json.email_addresses }}"

## üí° AI-Powered Ideas for Improvement
**Explain:**  
This n8n workflow automates the process of managing new leads from a website. It starts by receiving lead data via a webhook from ERPNext. The workflow checks if the lead's source is the website and if the status is open. If valid, it fetches lead details, processes the information using an AI agent to categorize and generate email responses, and finally sends notifications to relevant contacts via Microsoft Outlook. Invalid leads are flagged and not processed further.

**Demonstrate:**  
A consulting firm could use this workflow to streamline lead management by automating the categorization and notification process, ensuring timely follow-up with potential clients and saving valuable time.

**Imitate:**  
1. Set up a webhook in ERPNext to trigger on new leads.  
2. Configure the n8n workflow to receive this data.  
3. Ensure the AI agent is set to analyze and categorize leads.  
4. Connect Microsoft Outlook to send emails based on AI output.  
5. Test with sample data to refine the workflow.

**Practice:**  
Create a test lead in ERPNext and observe how the workflow processes it. Modify the lead data to see how the AI agent categorizes different types of inquiries and how the email notifications are generated.

**WIIFM:**  
Mastering this workflow allows you to offer automated lead management services to clients, enhancing their efficiency and ensuring no lead is overlooked. This can increase your service portfolio, attract more clients, and boost income in the AI automation business.

## üîß Setup Instructions
1. **Connect Credentials:** openAiApi, googleSheetsOAuth2Api, microsoftOutlookOAuth2Api, googleDocsOAuth2Api, erpNextApi.
2. **Data Mapping:** Verify base/sheet IDs and column names match exactly to prevent silent failures.
3. **API Contracts:** Validate required headers and 2xx/4xx handling; add retries for 429/5xx.

### ‚ö†Ô∏è Automation Ain‚Äôt the Same Anymore

Most builders out here are stuck doing $500 workflows and calling it a win.  
That‚Äôs not the move.  

I'm closing $6k‚Äì$13k deals by stacking simple automations with lightweight AI...  
and it takes me under 2 hours to build most of them.

#### üß† Examples From My Own Playbook:
- üîÅ Turned a recurring invoice workflow into a $6,000 retainer that saved 20 hours/week  
- ‚öñÔ∏è Built an AI-powered lead gen engine for law firms ‚Äî they paid $13,000 happily  
- üöÄ Launched an SEO agent that outperforms funded companies ‚Äî using free OpenAI credits  

**Want to learn how to do the same?**  
Inside [Digital Boss Code](https://bigpoppacode.io/go/dbc), I break it all down:

‚úÖ The exact AI components that 3x your pricing overnight  
‚úÖ My $15k Automation Framework using n8n + LangChain  
‚úÖ Word-for-word scripts to close high-ticket deals  
‚úÖ Real client case studies with templates  
‚úÖ How to stop looking like a tech VA and start moving like a Solution Architect  

üî• Get started at ‚Üí [bigpoppacode.io/go/dbc](https://bigpoppacode.io/go/dbc)  
Limited time access, early birds get the best bonuses.

---
> Built by [Big Poppa Code](https://bigpoppacode.io) ‚Äì architecting automations that scale people, profits, and purpose.
