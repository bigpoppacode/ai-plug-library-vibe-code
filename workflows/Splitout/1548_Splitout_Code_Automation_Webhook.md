# Splitout Code Automation Webhook
## 🚀 What It Does
Calls external APIs and uses **AI** to transform or decide, then routes the result downstream.

## 💼 Business Use Case
Use as a **glue/API broker**: receive data, enrich/validate via APIs, and pass to downstream systems.

## ⚙️ How It Works
1. **Trigger:** This workflow starts with **Create a simple Trigger to have the Chat button within N8N**.
2. **Window Buffer Memory** `memoryBufferWindow` — configured for its default action.
3. **Sticky Note4** `stickyNote` — color: "3", width: "840", height: "80"
4. **Sticky Note** `stickyNote` — color: "5", width: "500", height: "720"
5. **Create a simple Trigger to have the Chat button within N8N** `chatTrigger` — options: "[object Object]"
6. **Sticky Note1** `stickyNote` — width: "300", content: "## Setup

- Configure OpenAI Key

### In this step, we will use an assistant created within the OpenAI platform that contains a vector store a.k.a file retrieval"
7. **Sticky Note2** `stickyNote` — content: "### Retrieving all thread content is necessary because the OpenAI tool does not retrieve all citations upon request."
8. **Sticky Note3** `stickyNote` — width: "200", height: "220", content: "### A file retrieval request contains a lot of information, and we want only the text that will be substituted and the file name.

- id
- filename
- text
"
9. **Sticky Note5** `stickyNote` — width: "200", height: "220", content: "### With the last three splits, we may have many citations and texts to substitute. By doing an aggregation, it will be possible to handle everything as a single request."
10. **Sticky Note6** `stickyNote` — height: "220", content: "### This simple code will take all the previous files and citations and alter the original text, formatting the output. In this way, we can use Markdown tags to create links, or if…[truncated]"
11. **OpenAI Assistant with Vector Store** `openAi` — resource: **assistant**
12. **Get ALL Thread Content** `httpRequest` — url: `=https://api.openai.com/v1/threads/{{ $json.threadId }}/messages`
13. **Split all message iterations from a thread** `splitOut` — options: "[object Object]", fieldToSplitOut: "data"
14. **Split all content from a single message** `splitOut` — options: "[object Object]", fieldToSplitOut: "content"
15. **Split all citations from a single message** `splitOut` — options: "[object Object]", fieldToSplitOut: "text.annotations"
16. **Retrieve file name from a file ID** `httpRequest` — url: `=https://api.openai.com/v1/files/{{ $json.file_citation.file_id }}`
17. **Regularize output** `set` — options: "[object Object]", assignments: "[object Object]"
18. **Aggregate** `aggregate` — options: "[object Object]", aggregate: "aggregateAllItemData"
19. **Finnaly format the output** `code` — mode: "runOnceForEachItem", jsCode: "let saida = $('OpenAI Assistant with Vector Store').item.json.output;

for (let i of $input.item.json.data) {
 saida = saida.replaceAll(i.text, " _("+ i.filename+")_ ");
}

$input.…[truncated]"
20. **Optional Markdown to HTML** `markdown` — html: "={{ $json.output }}", options: "[object Object]", destinationKey: "output"

## 💡 AI-Powered Ideas for Improvement
- **Explain:** This n8n workflow retrieves content from OpenAI threads and processes it to format citations using Markdown or HTML tags. It gathers all message content, splits the information, retrieves file names, and finally formats the output to ensure that text is correctly cited with file references.

- **Demonstrate:** A business owner might use this workflow to ensure that all content generated by an AI assistant is accurately cited with references, reducing errors in documentation and enhancing the credibility of AI-generated reports or articles.

- **Imitate:** Import the workflow into n8n, configure OpenAI credentials, and set up the vector store with your files. Test the workflow with a sample thread ID to see how it retrieves and formats citations. Customize the formatting code to suit your output preferences.

- **Practice:** Create a test thread in OpenAI with multiple citations. Run the workflow to observe how it processes and formats these citations. Experiment with different Markdown or HTML tags to see how the output changes.

- **WIIFM:** Mastering this workflow enables you to offer enhanced content validation services, ensuring AI-generated content is properly cited. This adds value to clients, improves content reliability, and can be a unique selling point in your automation business.

## 🔧 Setup Instructions
1. **Connect Credentials:** openAiApi.
2. **API Contracts:** Validate required headers and 2xx/4xx handling; add retries for 429/5xx.

### ⚠️ Automation Ain’t the Same Anymore

Most builders out here are stuck doing $500 workflows and calling it a win.  
That’s not the move.  

I'm closing $6k–$13k deals by stacking simple automations with lightweight AI...  
and it takes me under 2 hours to build most of them.

#### 🧠 Examples From My Own Playbook:
- 🔁 Turned a recurring invoice workflow into a $6,000 retainer that saved 20 hours/week  
- ⚖️ Built an AI-powered lead gen engine for law firms — they paid $13,000 happily  
- 🚀 Launched an SEO agent that outperforms funded companies — using free OpenAI credits  

**Want to learn how to do the same?**  
Inside [Digital Boss Code](https://bigpoppacode.io/go/dbc), I break it all down:

✅ The exact AI components that 3x your pricing overnight  
✅ My $15k Automation Framework using n8n + LangChain  
✅ Word-for-word scripts to close high-ticket deals  
✅ Real client case studies with templates  
✅ How to stop looking like a tech VA and start moving like a Solution Architect  

🔥 Get started at → [bigpoppacode.io/go/dbc](https://bigpoppacode.io/go/dbc)  
Limited time access, early birds get the best bonuses.

---
> Built by [Big Poppa Code](https://bigpoppacode.io) – architecting automations that scale people, profits, and purpose.
